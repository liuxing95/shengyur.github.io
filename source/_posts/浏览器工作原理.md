title: 浏览器的工作原理
date: 2018/09/30
categories: 前端基础
tags:
  - WEB
---

### 什么情况下会触发浏览器的repaint/reflow?
除了页面在首次加载时必然要经历该过程之外，还有以下行为会触发这个行为：
1.DOM结构改变，比如删除了某个节点
2.render树变化，比如减少了padding
3.窗口resize
4.**读取元素的某些属性（offsetLeft、offsetTop、offsetHeight、offsetWidth、scrollTop/Left/Width/Height、clientTop/Left/Width/Height、getComputedStyle()、currentStyle(in IE))**

### 如何优化你的脚本来减少reflow/repaint?
1. 避免在document上直接进行频繁的DOM操作，如果确实需要可以采用off-document的方式进行，具体的方法包括但不完全包括以下几种：
(1). 先将元素从document中删除，完成修改后再把元素放回原来的位置

(2). 将元素的display设置为”none”，完成修改后再把display修改为原来的值

(3). 如果需要创建多个DOM节点，可以使用DocumentFragment创建完后一次性的加入document

2. 集中修改样式
(1). 尽可能少的修改元素style上的属性

(2). 尽量通过修改className来修改样式

(3). 通过cssText属性/className来设置样式值

```
document.getElementById("d1").style.cssText = "color:red; font-size:13px;";
```

3. 缓存Layout属性值
对于Layout属性中非引用类型的值（数字型），如果需要多次访问则可以在一次访问时先存储到局部变量中，之后都使用局部变量，这样可以避免每次读取属性时造成浏览器的渲染。
```
var width = el.offsetWidth; var scrollLeft = el.scrollLeft;
```

4. 设置元素的position为absolute或fixed

参考：
- ![https://www.cnblogs.com/fullhouse/archive/2012/02/20/2360301.html](如何减少浏览器repaint和reflow)
- ![https://mp.weixin.qq.com/s/LIfvU8j0gBVIFF8AYYtfFg](从输入URL到页面加载的过程？)